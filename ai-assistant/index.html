<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>探月助手小嫦</title>
    <style>
        :root {
            --primary-color: #1a73e8;
            --primary-light: #e8f0fe;
            --secondary-color: #1557b0;
            --background-color: #ffffff;
            --text-color: #333;
            --chat-bg: #f8f9fa;
            --border-color: #e0e0e0;
            --message-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            --tech-gradient: linear-gradient(135deg, #1a73e8, #0052cc);
            --tech-glow: 0 0 20px rgba(26, 115, 232, 0.15);
        }

        /* ... existing styles until #assistant-header ... */

        #assistant-header {
            background: var(--tech-gradient);
            color: white;
            padding: 14px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
        }

        #assistant-title {
            margin: 0;
            font-size: 1.2em;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            flex-grow: 1;
            text-align: center;
        }

        #minimize-button {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            color: white;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        #minimize-button:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
        }

        /* Language selector styles */
        .language-section {
            padding: 10px 20px;
            background-color: var(--background-color);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #language-select {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: white;
            color: var(--text-color);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
        }

        #language-select:hover {
            border-color: var(--primary-color);
        }

        #language-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-light);
        }

        /* ... rest of existing styles ... */
    </style>
</head>
<body>
    <div id="assistant-container">
        <div id="assistant-header">
            <h2 id="assistant-title">探月助手</h2>
            <button id="minimize-button">−</button>
        </div>
        <div id="chat-container"></div>
        <div class="language-section">
            <select id="language-select">
                <option value="zh-tw">繁體中文</option>
                <option value="en">English</option>
            </select>
        </div>
        <div id="input-container">
            <input type="text" id="user-input" placeholder="请输入您的问题...">
            <button id="send-button">发送</button>
        </div>
    </div>

    <script type="module">
        import SpaceKnowledgeBase from './knowledge-base-handler.js';
        import config from './config.js';

        const knowledgeBase = new SpaceKnowledgeBase();
        let currentLang = 'zh';

        const translations = {
            'zh-tw': {
                title: '探月助手',
                welcomeMessage: '你好！我是探月助手小嫦，很高興為您服務。請問有什麼我可以幫助您的嗎？',
                placeholder: '請輸入您的問題...',
                sendButton: '發送',
                errorMessage: '抱歉，處理您的請求時出現了錯誤。'
            },
            'en': {
                title: 'Lunar Assistant',
                welcomeMessage: 'Hello! I am Chang\'e, your Lunar Mission Assistant. How may I help you today?',
                placeholder: 'Type your question...',
                sendButton: 'Send',
                errorMessage: 'Sorry, there was an error processing your request.'
            }
        };

        // Initialize UI elements
        const assistantContainer = document.getElementById('assistant-container');
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const minimizeButton = document.getElementById('minimize-button');
        const assistantTitle = document.getElementById('assistant-title');
        const languageSelect = document.getElementById('language-select');

        // Update UI text based on language
        function updateUIText() {
            const text = translations[currentLang];
            assistantTitle.textContent = text.title;
            userInput.placeholder = text.placeholder;
            sendButton.textContent = text.sendButton;
        }

        // Language selection handler
        languageSelect.addEventListener('change', (e) => {
            currentLang = e.target.value;
            knowledgeBase.setLanguage(currentLang);
            updateUIText();
        });

        // Initialize the assistant
        async function initialize() {
            try {
                const loaded = await knowledgeBase.loadData();
                if (loaded) {
                    addMessage(translations[currentLang].welcomeMessage, 'assistant');
                } else {
                    addMessage(translations[currentLang].errorMessage, 'assistant');
                }
            } catch (error) {
                console.error('Initialization error:', error);
                addMessage(translations[currentLang].errorMessage, 'assistant');
            }
        }

        // ... rest of existing script ... 
    </script>
</body>
</html>
